# 比特币的10分钟挖矿难度是怎么来的

首先这个十分钟是比特币中规定好了的，并不是说如果矿工的矿机性能好了以后就能缩短这个时间。

## 哈希函数

#### 特点一

首先我们先要清楚什么是哈希函数，说到函数自然想到我们中学所学的函数y=f(x),y是因变量，x是自变量。函数就有值域和定义域，我们可以简单的理解哈希函数就是值域规定好的，值域无限大的一种函数。
比如函数 y=x%10，(%是取余运算)，这个函数额值域也就是这个函数的输出是规定好了的。比如我们哈希函数sha256输出的值域是[0-(2^256-1)] 

#### 特点二

这个函数是单向的，也就是说我们可以通过x求出y，但是我们有了y不能求出x，着在计算上是不可行的，着就是所谓的单向性。

#### 特点三

哈希函数输入只要不同则输出在很大的概率上是不同的，如果我们知道着x1的函数值是y1但是我们在计算上要找另一个x2的哈希值也是y1是不行的。同时如果哈希函数的输入只要一点不同哈希函数的输出是千差万别的。也不行通过输入去判断输出是多少。

哈希函数的特点还有很多，这里就只知道着几个特点就行了，如果还不理解可以去百度一下哈希

## 挖矿

所谓的挖矿就是把一个交易打包进一个区块里面然后矿工去计算着区块里面的哈希值，区块里面又个参数叫Nonce，这是用来给矿工挖矿的一个随机数，矿工自己可以随意改变，通过改变区块中的Nonce矿工可以得到不同的很多个hash，只要这个hash值满足难度条件，那么这个矿工就挖到了这个区块谈后就可以广播获取奖励了。（这里要知道这个计算的过程矿工只能通过穷举的办法去寻找这个满足条件的hash值，从了我们就理解到了为什么从最早的CPU挖矿变为后面的GPU挖矿，知道后来的专业矿机，因为GPU更擅长重复的运算）

## 难度表示

我们在区块中看到难度目标，其被标为"难度位"或简称"bits"。在区块277,316中，它的值为 0x1903a30c。 这个标记的值被存为系数/指数格式，前两位十六进制数字为幂(exponent)，接下来得六位为系 数(coefficient)。在这个区块里，0x19为幂，而 0x03a30c为系数。
>target = 0x03a30c * 2^(0x08 * (0x19 ‐ 0x03))^
>target = 0x03a30c * 2^(0x08 * 0x16)^
>target = 0x03a30c * 2^0xB0
最后计算出来的难度的十六进制表示：
>target =0x0000000000000003A30C00000000000000000000000000000000000000000000
矿工计算出的哈希值要满足小于target值才行

那么如果不断加入到矿工的人加入到这个行业中，肯定相应的全网算力会不断的提高，比特币系统是怎么控制然后每10分钟产生一个区块的呢？

## 难度控制

比特币的区块平均每10分钟生成一个。这就是比特币的心跳，是货币发行速率和交易达成速度的基础。不仅是在短 期 内，而是在几十年内它都必须要保持恒定。在此期间，计算机性能将飞速提升。此外，参与挖矿的人和计算机也 会不断 变化。为了能让新区块的保持10分钟一个的产生速率，挖矿的难度必须根据这些变化进行调整。事实上， 难度是一个动 态的参数，会定期调整以达到每10分钟一个新区块的目标。简单地说，难度被设定在，无论挖矿能 力如何，新区块产生 速率都保持在10分钟一个。
那么，在一个完全去中心化的网络中，这样的调整是如何做到的呢?难度的调整是在每个完整节点中独立自动发生 的。 每2,016个区块中的所有节点都会调整难度。难度的调整公式是由最新2,016个区块的花费时长与20,160分钟 (即 这些区块以10分钟一个速率所期望花费的时长)比较得出的。难度是根据实际时长与期望时长的比值进行相 应调整的 (或变难或变易)。简单来说，如果网络发现区块产生速率比10分钟要快时会增加难度。如果发现比10 分钟慢时则降低 难度。
这个公式可以总结为如下形式:

>下一个区块的难度 = 上一个区块的难度 * ( 前2016个区块产生的总时间/ 2016*10 minutes)

这样就达到了动态控制每个区块产生的时间，虽然在短期内控制的不是那么准确。



